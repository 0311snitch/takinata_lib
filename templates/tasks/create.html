<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>

{% extends 'adminlte/base.html' %}
{% block title %}Task Create{% endblock %}
{% load i18n static %}

{% block body_class %}login-page{% endblock %}

{% block content %}
    <section class="content-header">
        <h1>Task list</h1>
    </section>
    <section class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6">
                    <div class="box box-primary">
                        <!-- /.login-logo -->
                        <div class="box-header with-border">
                            <h3 class="box-title">Task Create</h3>
                        </div>
                        <div class="box-body">
                            <form method="post">
                                {% csrf_token %}
                                    {% if message %}
                                        <p class="login-box-msg" style="color: red;">{{ message }}</p>
                                    {% endif %}
                                {% for field in form %}
                                  <div class="form-group has-feedback">
                                    {{ field }}
                                     {% if field.help_text %}
                                          <small style="color: grey">{{ field.help_text | safe }}</small>
                                    {% endif %}
                                    {% for error in field.errors %}
                                      <p style="color: red">{{ error }}</p>
                                    {% endfor %}

                                  </div>
                                {% endfor %}
                                <label>
                                    {% if projects %}
                                        <select id='select_project' class="form-control js-example-basic-single"
                                                name="select_project">
                                            {% for project in projects %}
                                                <option value={{ project.id }}>{{ project.name }}</option>
                                            {% endfor %}
                                        </select>
                                    {% endif %}
                                    {% if project %}
                                        <select id='select_project' class="form-control js-example-basic-single"
                                                name="select_project">
                                            {% for project in projects %}
                                                <option value={{ project.id }}>{{ project.name }}</option>
                                            {% endfor %}
                                        </select>
                                    {% endif %}
                                </label>
                                <label>
                                    <select id='select_column' class="form-control js-example-basic-single" name="select_column">
                                        {% for column in columns %}
                                            <option value={{ column.project_id }}>{{ column.name }}</option>
                                        {% endfor %}
                                    </select>
                                </label>
                                 <div class="box-footer">
                                    <div class="row">
                                        <div class="col-xs-8"></div>
                                        <div class="col-xs-4">
                                            <button type="submit" class="btn btn-primary btn-block btn-flat">Create</button>
                                        </div>
                                    </div>
                                </div>
                              </form>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <h3 class="box-title">Task info</h3>
                        </div>
                        <div class="box-body">
                            <h3>What is task?</h3>
                            <p class="lead">
                                A task is some action that you want to do in the future.</p>
                            <hr>
                            <h3>For what?</h3>
                            <p class="lead">
                                The modern world lives very quickly and there are always a lot of tasks that need to be
                                quickly written down so as not to forget. It can be all sorts of tasks, ranging from
                                simple, like "buy products", ending with some "build a house." The ability to create
                                and store anywhere a task will help not forget to do important things.
                            </p>
                            <hr>
                            <h3>Example of use</h3>
                            <p class="lead">
                                - The task "Buy products" can contain in the description a list of everything you
                                need to buy for dinner.<br>
                                - The task "Make a homework" can contain in the description a list of subjects and
                                tasks for them that you need to accomplish by a certain date.<br>
                                - The "Contact with organizers" task allows you to store in the description the names
                                and numbers of those people who need to call.<br>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>
        $('#select_column').parent().hide();
        var $selected_column = $( '#select_column' ),
        $options = $selected_column.find( 'option' );
        $(document).ready(function() {
        });
        $(document).ready(function(){
            $('#select_project').on("select2:select", function(e) {
                $selected_column.html( $options.filter( '[value="' + this.value + '"]' ) );
                $('#select_column').parent().show();
                $("#select_column").prop("selectedIndex", -1);
                console.log(this.value);
            });
        });
        $("#select_project").prop("selectedIndex", -1);
    </script>
{% endblock %}