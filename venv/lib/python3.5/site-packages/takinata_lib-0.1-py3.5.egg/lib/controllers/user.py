import lib.logger as logger
from lib.models.models import User
from lib.storage.user import UserStorage
from lib.exception import UserAlreadyExist


class UserController:
    log_tag = "UserController"

    @classmethod
    def reg(cls, username, password, email):
        """
        User registration with the specified data
        :param username: desired user name
        :param password: desired password
        :param email: desired e-mail
        :return:
        """
        log = logger.get_logger(UserController.log_tag)
        user = User(username=username, password=password, email=email)
        users = UserStorage.get_all_users()
        have = False
        for i in users:
            if i.username == user.username:
                have = True
        if not have:
            UserStorage.add_user_to_db(user)
            return user
        else:
            log.error("User with this name is already exist")
            raise UserAlreadyExist
